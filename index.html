<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8"/>
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
Â  <title>Budget + Calendar + Chart</title>
Â  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
Â  <style>
Â  Â  :root{--p:#6366f1;--g:#10b981;--r:#ef4444;--b:#f5f5f5}
Â  Â  *{box-sizing:border-box;margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif}
Â  Â  body{background:var(--b);padding:20px;color:#1f2937}
Â  Â  .card{background:#fff;border-radius:12px;padding:20px;margin-bottom:20px;box-shadow:0 2px 8px rgba(0,0,0,.08)}
Â  Â  h1{text-align:center;margin-bottom:20px;font-weight:600;font-size:1.5rem}
Â  Â  .sum{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
Â  Â  .sum div{text-align:center;padding:14px;border-radius:8px;color:#fff;font-weight:600}
Â  Â  .sum div h3{font-size:.75rem;opacity:.9;font-weight:400}
Â  Â  .sum .i{background:var(--g)}.sum .e{background:var(--r)}.sum .t{background:var(--p)}
Â  Â  .grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}
Â  Â  form{display:grid;grid-template-columns:1fr 1fr;gap:10px}
Â  Â  input,select{width:100%;padding:10px;border:1px solid #d1d5db;border-radius:8px;font-size:1rem}
Â  Â  button{grid-column:1/-1;padding:10px;background:var(--p);color:#fff;border:none;border-radius:8px;font-size:1rem;cursor:pointer}
Â  Â  button:hover{background:#4f46e5}
Â  Â  .cal-nav{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
Â  Â  .cal-nav button{width:auto;padding:6px 12px;background:#e5e7eb;color:#111}
Â  Â  .cal-nav button:hover{background:#d1d5db}
Â  Â  .month-display{font-size:1.25rem;font-weight:600}
Â  Â  .cal-head,.cal{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;text-align:center}
Â  Â  .cal-head{font-size:.75rem;font-weight:600;color:#6b7280;margin-bottom:4px}
Â  Â  .cal-day{aspect-ratio:1/1;display:flex;flex-direction:column;align-items:center;justify-content:center;border-radius:8px;font-size:.875rem;cursor:pointer;position:relative}
Â  Â  .cal-day:hover{background:#f3f4f6}
Â  Â  .cal-day.today{background:var(--p);color:#fff;font-weight:700}
Â  Â  .cal-day.other-month{color:#d1d5db}
Â  Â  .dots{position:absolute;bottom:4px;display:flex;gap:2px}
Â  Â  .dot{width:3px;height:3px;border-radius:50%}
Â  Â  .dot.income{background:var(--g)}.dot.expense{background:var(--r)}
Â  Â  .list{max-height:280px;overflow-y:auto}
Â  Â  .item{display:flex;justify-content:space-between;align-items:center;padding:10px;border-bottom:1px solid #eee}
Â  Â  .item:last-child{border-bottom:none}
Â  Â  .item:hover .del{opacity:1}
Â  Â  .del{background:var(--r);color:#fff;border:none;width:20px;height:20px;border-radius:50%;cursor:pointer;font-size:14px;line-height:1;opacity:0;transition:.2s}
Â  Â  .amt.income{color:var(--g)}.amt.expense{color:var(--r)}
Â  Â  .del-zone{background:#fef2f2;border:1px dashed #fca5a5;border-radius:8px;padding:12px;text-align:center}
Â  Â  .del-zone h4{color:#b91c1c;margin-bottom:8px;font-size:.9rem}
Â  Â  .del-actions{display:flex;gap:8px}
Â  Â  .del-actions button{background:var(--r);font-size:.8rem;padding:6px}
Â  Â  .del-actions button:hover{background:#dc2626}
Â  Â  .chart-container{height:200px;margin-top:10px}
Â  Â  @media(max-width:700px){.grid{grid-template-columns:1fr}.sum{grid-template-columns:1fr}}
Â  </style>
</head>
<body>

<div class="container">
Â  Â  <div class="card">
Â  Â  <h1>ğŸ’° Budget + Calendar + Chart</h1>
Â  Â  <div class="sum">
Â  Â  Â  <div class="i"><h3>Income</h3><span id="inc">$0.00</span></div>
Â  Â  Â  <div class="e"><h3>Expenses</h3><span id="exp">$0.00</span></div>
Â  Â  Â  <div class="t"><h3>Balance</h3><span id="sol">$0.00</span></div>
Â  Â  </div>
Â  </div>

Â  Â  <div class="grid">
Â  Â  <div class="card">
Â  Â  Â  <h2>Add transaction</h2>
Â  Â  Â  <form id="form">
Â  Â  Â  Â  <input id="desc" type="text" placeholder="Description" required>
Â  Â  Â  Â  <input id="mnt" type="number" step="0.01" placeholder="Amount" required>
Â  Â  Â  Â  <select id="typ" required><option value="">Type</option><option value="income">Income</option><option value="expense">Expense</option></select>
Â  Â  Â  Â  <select id="cur" required><option value="">Currency</option><option value="EUR">EUR</option><option value="USD">USD</option></select>
Â  Â  Â  Â  <select id="cat" required><option value="">Category</option><option value="salary">Salary</option><option value="food">Food</option><option value="housing">Housing</option><option value="transport">Transport</option><option value="other">Other</option></select>
Â  Â  Â  Â  <input id="dat" type="date" required>
Â  Â  Â  Â  <button type="submit">Add</button>
Â  Â  Â  </form>
Â  Â  </div>

Â  Â  <div class="card">
Â  Â  Â  <div class="cal-nav">
Â  Â  Â  Â  <button id="prev">â€¹</button><div class="month-display" id="mois"></div><button id="next">â€º</button>
Â  Â  Â  </div>
Â  Â  Â  <div class="cal-head"><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div><div>Sun</div></div>
Â  Â  Â  <div id="cal" class="cal"></div>
Â  Â  </div>
Â  </div>

Â  Â  <div class="grid">
Â  Â  <div class="card"><h2>This month transactions</h2><div id="list" class="list"></div></div>
Â  Â  <div class="card">
Â  Â  Â  <h2>Expense breakdown</h2>
Â  Â  Â  <div class="chart-container"><canvas id="chart"></canvas></div>
Â  Â  </div>
Â  </div>

Â  Â  <div class="card del-zone">
Â  Â  <h4>ğŸ—‘ï¸ Delete data</h4>
Â  Â  <div class="del-actions">
Â  Â  Â  <button id="delLast">Delete last</button>
Â  Â  Â  <button id="delMonth">Delete month</button>
Â  Â  Â  <button id="reset">Reset all</button>
Â  Â  </div>
Â  </div>
</div>

<script>
/* ---------- CONFIG ---------- */
const EUR2USD = 1.08;
let DATA = JSON.parse(localStorage.getItem('budgetEn')) || [];
let CUR_DATE = new Date();
let CHART;

/* ---------- UTILS ---------- */
const $ = id => document.getElementById(id);
const save = () => localStorage.setItem('budgetEn', JSON.stringify(DATA));
const fmt = n => n.toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2});

/* ---------- TOTALS ---------- */
function refreshTotals(){
Â  const inc = DATA.filter(t => t.type === 'income').reduce((s, t) => s + t.usd, 0);
Â  const exp = DATA.filter(t => t.type === 'expense').reduce((s, t) => s + t.usd, 0);
Â  $('inc').textContent = '$' + fmt(inc);
Â  $('exp').textContent = '$' + fmt(exp);
Â  $('sol').textContent = '$' + fmt(inc - exp);
}

/* ---------- CALENDAR ---------- */
function buildCalendar(){
Â  const y = CUR_DATE.getFullYear(), m = CUR_DATE.getMonth();
Â  $('mois').textContent = new Date(y, m).toLocaleDateString('en-US', {year: 'numeric', month: 'long'});
Â  const first = new Date(y, m, 1), last = new Date(y, m + 1, 0);
Â  const start = new Date(first); start.setDate(start.getDate() - first.getDay() + 1);
Â  $('cal').innerHTML = '';
Â  for (let i = 0; i < 42; i++) {
Â  Â  const d = new Date(start); d.setDate(start.getDate() + i);
Â  Â  const dayDiv = document.createElement('div'); dayDiv.className = 'cal-day'; dayDiv.textContent = d.getDate();
Â  Â  if (d.getMonth() !== m) dayDiv.classList.add('other-month');
Â  Â  if (d.toDateString() === new Date().toDateString()) dayDiv.classList.add('today');
Â  Â  const dayTrans = DATA.filter(t => new Date(t.date).toDateString() === d.toDateString());
Â  Â  if (dayTrans.length) {
Â  Â  Â  const dots = document.createElement('div'); dots.className = 'dots';
Â  Â  Â  if (dayTrans.some(t => t.type === 'income')) {
Â  Â  Â  Â  const dot = document.createElement('div'); dot.className = 'dot income'; dots.appendChild(dot);
Â  Â  Â  }
Â  Â  Â  if (dayTrans.some(t => t.type === 'expense')) {
Â  Â  Â  Â  const dot = document.createElement('div'); dot.className = 'dot expense'; dots.appendChild(dot);
Â  Â  Â  }
Â  Â  Â  dayDiv.appendChild(dots);
Â  Â  }
Â  Â  dayDiv.addEventListener('click', () => { $('dat').valueAsDate = d; });
Â  Â  $('cal').appendChild(dayDiv);
Â  }
}

/* ---------- MONTH LIST ---------- */
function refreshList(){
Â  const y = CUR_DATE.getFullYear(), m = CUR_DATE.getMonth();
Â  const monthTrans = DATA.filter(t => {
Â  Â  const d = new Date(t.date);
Â  Â  return d.getFullYear() === y && d.getMonth() === m;
Â  }).sort((a, b) => new Date(b.date) - new Date(a.date));
Â  $('list').innerHTML = '';
Â  if (!monthTrans.length) {
Â  Â  $('list').innerHTML = '<p style="text-align:center;color:#9ca3af">No transactions this month</p>';
Â  Â  return;
Â  }
Â  monthTrans.forEach(t => {
Â  Â  const div = document.createElement('div'); div.className = 'item';
Â  Â  div.innerHTML = `
Â  Â  Â  <div><strong>${t.desc}</strong><br><small>${t.cat} â€¢ ${new Date(t.date).toLocaleDateString('en-US')}</small></div>
Â  Â  Â  <div style="text-align:right"><div class="amt ${t.type}">${t.amt} ${t.cur}</div><small>$${fmt(t.usd)}</small></div>
Â  Â  Â  <button class="del" onclick="delTrans(${t.id})">Ã—</button>`;
Â  Â  $('list').appendChild(div);
Â  });
}

/* ---------- CHART ---------- */
function refreshChart(){
Â  const ctx = $('chart').getContext('2d');
Â  if (CHART) CHART.destroy();
Â  const exp = DATA.filter(t => t.type === 'expense').reduce((a, t) => {
Â  Â  a[t.cat] = (a[t.cat] || 0) + t.usd;
Â  Â  return a;
Â  }, {});
Â  if (!Object.keys(exp).length) {
Â  Â  ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
Â  Â  return;
Â  }
Â  CHART = new Chart(ctx, {
Â  Â  type: 'doughnut',
Â  Â  data: {
Â  Â  Â  labels: Object.keys(exp),
Â  Â  Â  datasets: [{
Â  Â  Â  Â  data: Object.values(exp),
Â  Â  Â  Â  backgroundColor: ['#6366f1','#8b5cf6','#ec4899','#f59e0b','#10b981']
Â  Â  Â  }]
Â  Â  },
Â  Â  options: {
Â  Â  Â  responsive: true,
Â  Â  Â  maintainAspectRatio: false
Â  Â  }
Â  });
}

/* ---------- DELETE ---------- */
window.delTrans = id => {
Â  if (confirm('Delete this transaction?')) {
Â  Â  DATA = DATA.filter(t => t.id !== id);
Â  Â  save();
Â  Â  refreshAll();
Â  }
};
$('delLast').onclick = () => {
Â  if (!DATA.length) {
Â  Â  alert('No transaction to delete.');
Â  Â  return;
Â  }
Â  if (confirm('Delete the last transaction?')) {
Â  Â  DATA.pop();
Â  Â  save();
Â  Â  refreshAll();
Â  }
};
$('delMonth').onclick = () => {
Â  const y = CUR_DATE.getFullYear(), m = CUR_DATE.getMonth();
Â  const toDel = DATA.filter(t => {
Â  Â  const d = new Date(t.date);
Â  Â  return d.getFullYear() === y && d.getMonth() === m;
Â  });
Â  if (!toDel.length) {
Â  Â  alert('This month is empty.');
Â  Â  return;
Â  }
Â  if (confirm(`Delete ${toDel.length} transaction(s) from this month?`)) {
Â  Â  DATA = DATA.filter(t => !toDel.includes(t));
Â  Â  save();
Â  Â  refreshAll();
Â  }
};
$('reset').onclick = () => {
Â  if (confirm('Delete all data permanently?')) {
Â  Â  if (confirm('Are you absolutely sure? This action cannot be undone.')) {
Â  Â  Â  DATA = [];
Â  Â  Â  save();
Â  Â  Â  refreshAll();
Â  Â  }
Â  }
};

/* ---------- FORM ---------- */
$('form').addEventListener('submit', e => {
Â  e.preventDefault();
Â  const usd = $('cur').value === 'USD' ? +$('mnt').value : +($('mnt').value * EUR2USD);
Â  DATA.push({
Â  Â  id: Date.now(),
Â  Â  desc: $('desc').value,
Â  Â  amt: +$('mnt').value,
Â  Â  cur: $('cur').value,
Â  Â  type: $('typ').value, // Fix: Changed 'typ' to 'type'
Â  Â  cat: $('cat').value,
Â  Â  date: $('dat').value,
Â  Â  usd
Â  });
Â  save();
Â  refreshAll();
Â  e.target.reset();
Â  $('dat').valueAsDate = new Date();
});

/* ---------- CAL NAV ---------- */
$('prev').onclick = () => { CUR_DATE.setMonth(CUR_DATE.getMonth() - 1); refreshAll(); };
$('next').onclick = () => { CUR_DATE.setMonth(CUR_DATE.getMonth() + 1); refreshAll(); };

/* ---------- BOOT ---------- */
function refreshAll(){
Â  refreshTotals();
Â  buildCalendar();
Â  refreshList();
Â  refreshChart();
}
refreshAll();
</script>
</body>
</html>
